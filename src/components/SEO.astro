---
export interface SEOProps {
	title: string;
	description?: string;
	image?: string;
	url?: string;
	type?: string;
	siteName?: string;
	locale?: string;
	keywords?: string[];
	author?: string;
	publishedTime?: string;
	modifiedTime?: string;
	articleSection?: string;
	tags?: string[];
	noIndex?: boolean;
	canonical?: string;
}

const {
	title,
	description = 'A modern portfolio blog showcasing web development, design, and technology insights.',
	image = '/og-image.jpg',
	url = new URL(Astro.url.pathname, Astro.site!).toString(),
	type = 'website',
	siteName = 'Portfolio Blog',
	locale = 'en_US',
	keywords = [],
	author = 'Curtis Johnson',
	publishedTime,
	modifiedTime,
	articleSection,
	tags = [],
	noIndex = false,
	canonical
} = Astro.props;

const fullTitle = type === 'article' ? `${title} | ${siteName}` : title;
const finalCanonical = canonical || url;
---

<!-- Primary Meta Tags -->
<title>{fullTitle}</title>
<meta name="title" content={fullTitle} />
<meta name="description" content={description} />
<meta name="keywords" content={keywords.join(', ')} />
<meta name="author" content={author} />
<meta name="robots" content={noIndex ? 'noindex, nofollow' : 'index, follow'} />
<meta name="googlebot" content={noIndex ? 'noindex, nofollow' : 'index, follow'} />

<!-- Canonical URL -->
<link rel="canonical" href={finalCanonical} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={url} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={new URL(image, Astro.site!).toString()} />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:alt" content={title} />
<meta property="og:site_name" content={siteName} />
<meta property="og:locale" content={locale} />

{articleSection && <meta property="article:section" content={articleSection} />}
{publishedTime && <meta property="article:published_time" content={publishedTime} />}
{modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}
{tags.map(tag => <meta property="article:tag" content={tag} />)}

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content={url} />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={new URL(image, Astro.site!).toString()} />
<meta name="twitter:image:alt" content={title} />
<meta name="twitter:creator" content="@curtis" />
<meta name="twitter:site" content="@curtis" />

<!-- Additional SEO Meta -->
<meta name="theme-color" content="#3b82f6" />
<meta name="msapplication-TileColor" content="#3b82f6" />

<!-- Language and Region -->
<html lang={locale.replace('_', '-')} />
<meta name="geo.region" content="US" />
<meta name="geo.placename" content="United States" />

<!-- Content Type and Encoding -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<!-- Viewport and Mobile -->
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-capable" content="yes" />

<!-- Verification Tags (add your actual verification codes) -->
<meta name="google-site-verification" content="your-google-verification-code" />
<meta name="msvalidate.01" content="your-bing-verification-code" />
<meta name="yandex-verification" content="your-yandex-verification-code" />

<!-- Structured Data -->
{type === 'article' && (
	<script type="application/ld+json" set:html={JSON.stringify({
		"@context": "https://schema.org",
		"@type": "BlogPosting",
		"headline": title,
		"description": description,
		"image": new URL(image, Astro.site!).toString(),
		"author": {
			"@type": "Person",
			"name": author,
			"url": new URL('/', Astro.site!).toString()
		},
		"publisher": {
			"@type": "Organization",
			"name": siteName,
			"logo": {
				"@type": "ImageObject",
				"url": new URL('/logo.jpg', Astro.site!).toString(),
				"width": 600,
				"height": 60
			}
		},
		"datePublished": publishedTime,
		"dateModified": modifiedTime,
		"mainEntityOfPage": {
			"@type": "WebPage",
			"@id": url
		},
		"keywords": keywords.join(', '),
		"articleSection": articleSection,
		"wordCount": Astro.props.wordCount || 0,
		"inLanguage": locale
	})} />
)}

{type === 'website' && (
	<script type="application/ld+json" set:html={JSON.stringify({
		"@context": "https://schema.org",
		"@type": "WebSite",
		"name": siteName,
		"description": description,
		"url": new URL('/', Astro.site!).toString(),
		"potentialAction": {
			"@type": "SearchAction",
			"target": new URL('/search?q={search_term_string}', Astro.site!).toString(),
			"query-input": "required name=search_term_string"
		},
		"publisher": {
			"@type": "Organization",
			"name": author,
			"url": new URL('/', Astro.site!).toString()
		}
	})} />)}

{type === 'blog' && (
	<script type="application/ld+json" set:html={JSON.stringify({
		"@context": "https://schema.org",
		"@type": "Blog",
		"name": title,
		"description": description,
		"url": url,
		"author": {
			"@type": "Person",
			"name": author
		},
		"publisher": {
			"@type": "Organization",
			"name": siteName
		},
		"inLanguage": locale
	})} />)}

<!-- RSS and Atom Feeds -->
<link rel="alternate" type="application/rss+xml" title={siteName} href="/rss.xml" />
<link rel="alternate" type="application/atom+xml" title={siteName} href="/atom.xml" />

<!-- Sitemap -->
<link rel="sitemap" type="application/xml" href="/sitemap.xml" />

<!-- DNS Prefetch for Performance -->
<link rel="dns-prefetch" href="//fonts.googleapis.com" />
<link rel="dns-prefetch" href="//cdnjs.cloudflare.com" />
<link rel="dns-prefetch" href="//www.google-analytics.com" />

<!-- Preconnect for Critical Resources -->
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin />