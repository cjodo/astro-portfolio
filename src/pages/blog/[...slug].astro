---
const { slug } = Astro.params 
import BlogLayout from "../../layouts/BlogLayout.astro"
import { db, BlogPosts, eq } from "astro:db";
import { Markdown } from "astro-remote";

import Title from "@/components/Markdown/Title.astro"

export const prerender = false

const postNotFound = () => {
	return new Response(null, {
		status: 404,
		statusText: "Post not found"
	})
}

if(!slug) {
	return postNotFound();
}

const post = await db.select().from(BlogPosts).where(eq(BlogPosts.slug, slug))

if(!post) {
	return postNotFound();
}

console.log(post)
---

<BlogLayout>
	<Markdown content={ post[0].content } components={{ h1: Title }} />
</BlogLayout>
